

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Overloading v.s. Redefining, and Conflicts &mdash; atlas 0.6 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="atlas 0.6 documentation" href="../../index.html"/>
        <link rel="up" title="The Axis Language" href="../axis.html"/>
        <link rel="next" title="Control Structures" href="control_structures.html"/>
        <link rel="prev" title="Defining Functions and Operators" href="def_func_op.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> atlas
          

          
          </a>

          
            
            
              <div class="version">
                0.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../gen_info.html">General Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial_with_examples.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../atlas_lib.html">atlas Library</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro.html">A Brief Introduction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../axis.html">The Axis Language</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="design_principles.html">Design Principles</a></li>
<li class="toctree-l3"><a class="reference internal" href="types.html">Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="array.html">Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="tuple_pattern.html">Tuple Displays and Pattern Matching</a></li>
<li class="toctree-l3"><a class="reference internal" href="implicit_conversion.html">Implicit Conversions</a></li>
<li class="toctree-l3"><a class="reference internal" href="def_mod_identifiers.html">Defining and Modifying Identifiers</a></li>
<li class="toctree-l3"><a class="reference internal" href="def_func_op.html">Defining Functions and Operators</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">Overloading v.s. Redefining, and Conflicts</a></li>
<li class="toctree-l3"><a class="reference internal" href="control_structures.html">Control Structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="recursion.html">Recursion</a></li>
<li class="toctree-l3"><a class="reference internal" href="split_comm.html">Splitting Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="in_out_redir.html">Output, Input, and Redirection</a></li>
<li class="toctree-l3"><a class="reference internal" href="misc.html">Miscellaneous Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="summary.html">Syntax Summary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../operators.html">Basic Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../builtin_atlas_functions.html">Built-In <strong>atlas</strong> Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usr_defined_functions.html">User Defined Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../source_library.html">Source Code Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../videos.html">Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trouble_shooting.html">Trouble Shooting</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">atlas</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../atlas_lib.html">atlas Library</a> &raquo;</li>
      
          <li><a href="../axis.html">The Axis Language</a> &raquo;</li>
      
    <li>Overloading v.s. Redefining, and Conflicts</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/library/axis/overload_redef_conflicts.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="overloading-v-s-redefining-and-conflicts">
<h1>Overloading v.s. Redefining, and Conflicts<a class="headerlink" href="#overloading-v-s-redefining-and-conflicts" title="Permalink to this headline">Â¶</a></h1>
<p>While the overload table can handle many definitions with the same function
(or operator) name, it must be able to tell them apart by the argument types
(the result type is usually not available when resolving an overloaded call,
so it cannot be used to distinguish overloaded definitions). Moreover some
implicit conversions can be applied to arguments, making some overloaded
argument types incompatible (for instance having separate definitions for
&#8216;vec&#8217; and &#8216;[int]&#8217; arguments is not possible, as arguments of these types can
be implicitly converted into one another). However if a new definition exactly
matches the argument types of a previous definition, the new definition is
taken to replace rather than to overload the previous definition. The reply
that axis gives to a definition indicates when this happens, for instance:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>set inner_class (RootDatum rd, string ict)=
let lt = Lie_type (rd), basis=^coroot_radical(rd)
in inner_class(rd, involution(lt, basis, ict))
</pre></div>
</div>
<p>(here and henceforth we suppress prompts for readability) leads to the reply:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>Redefined inner_class: (RootDatum,string-&gt;InnerClass)
</pre></div>
</div>
<p>showing that a previous (in this case built-in) definition of &#8216;inner_class&#8217;
has been superseded and has become unavailable (the user-defined version has
replaced it; as it happens, it is almost equivalent to the built-in version).</p>
<p>Here is an example where an attempt to add an overloaded definition for a
different but closely related argument type is refused (attempt to overload
the variant defined above with &#8216;ratvec&#8217; second argument with a similar
instance with a &#8216;[rat]&#8217; second argument:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>set inner_class (LieType lt,[rat] gen,string ict)=
inner_class(lt, [ratvec: gen],ict)
</pre></div>
</div>
<p>gives the somewhat elaborate error message:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>Cannot overload `inner_class&#39;: previous type (LieType,ratvec,string)
is too close to (LieType,[rat],string),
making overloading potentially ambiguous. Broadness cannot disambiguate,
as either type converts to the other, definition aborted.
</pre></div>
</div>
<p>The &#8220;broadness&#8221; phrase relates to the fact that one can for instance overload
with types &#8216;int&#8217; and &#8216;rat&#8217;, even though the former can be implicitly converted
to the latter: since the opposite is not possible, &#8216;rat&#8217; is considered the
broader of the two types, and overload resolution will proceed by trying the
broader type only if no matching for the narrower type is possible. But
between &#8216;ratvec&#8217; and &#8216;[rat]&#8217; conversions in either direction are possible, so
axis cannot decide which overload would have to be tried first, whence its
refusal of the overloaded definition. Note that the full argument types here
are &#8216;(LieType,ratvec,string)&#8217; respectively &#8216;(LieType,[rat],string)&#8217;, which are
not directly convertible (just their second components are), but ambiguity may
still arise in function calls; axis is conservative and prefers to refuse
potentially ambiguous overloads when the ambiguity is introduced, rather than
to wait for a usage that actually exposes the ambiguity (at which point it may
have become hard to hunt down the offending definitions).</p>
<p>If one wants to replace the old definition so that one with a close but
distinct type can be accepted, a command &#8216;forget&#8217; can be used; here:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>atlas&gt; forget inner_class@(LieType,ratvec,string)
Definition of inner_class@(LieType,ratvec,string) forgotten
</pre></div>
</div>
<p>after which the definition attempted and refused above will be accepted.</p>
<p>Functions can also be unnamed values, which is particularly useful if the are
to be passed as arguments to other functions. So supposing g was defined by:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>atlas&gt; set g ((int-&gt;int) f) = vec: [f(0),f(f(1)),f(5)]
Defined g: ((int-&gt;int)-&gt;vec)
</pre></div>
</div>
<p>a function that takes as parameter another function, of type &#8216;(int-&gt;int)&#8217;. As
argument of &#8216;g&#8217; one can provide an anonymous function, for instance one that
adds 1 to an integer, which can be denoted by &#8216;(int n) : n+1&#8217;, or to make the
return type explicit &#8216;(int n) int: n+1&#8217; (the syntax is a parenthesized
parameter list, an optional return type followed by a colon, and an expression
giving the function body). One can now call g with this argument:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>atlas&gt; g((int n):n+1)
Value: [ 1, 3, 6 ]
</pre></div>
</div>
<p>One can also call &#8216;g&#8217; with a named function &#8216;f&#8217;. However since defining a
named function just introduces an overload for the function name, a bare &#8216;f&#8217;
does not suffice; one needs to specify the argument type for &#8216;f&#8217; in the call
of &#8216;g&#8217;:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>atlas&gt; set f (int n) = 3*n+1
Defined f: (int-&gt;int)
atlas&gt; g(f)
Error during analysis of expression at...
  Undefined identifier f
Type check failed
atlas&gt; g(f@int)
Value: [  1, 13, 16 ]
</pre></div>
</div>
<p>Note that &#8216;f&#8217; was called &#8220;Undefined&#8221; even though a function &#8216;f&#8217; is defined: in
the call &#8216;g(f)&#8217; the name &#8216;f&#8217; is not called, and bindings of &#8216;f&#8217; in the
overload table are not considered. Using &#8216;set&#8217; with a value of function type
always enters in into the overload table, even when it is for instance written:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>atlas&gt; set f = (int n): 3*n+1
Redefined f: (int-&gt;int)
</pre></div>
</div>
<p>To get a global variable whose value happens to have function type, a special
syntax is provided, namely &#8216;name : function&#8217; instead of &#8216;set name = function&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>atlas&gt;  f : (int n): 2*n+3
Identifier f: (int-&gt;int)
atlas&gt; g(f)
Value: [  3, 13, 13 ]
</pre></div>
</div>
<p>A global identifier defined with a function value in this way can coexist with
one or more overloaded instances for the same name. However, the presence of
overloaded instances make the function variable unavailable for use in direct
function calls, though it can still be used to pass the function value, assign
it to local variables, or assign a new function (of the same type) to it.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>atlas&gt; f(10) { overloaded instance }
Value: 31
atlas&gt; let ff=f in ff(10) { pass global variable to local one, then call it }
Value: 23
atlas&gt; f := ((int n) int: n*n) { syntax requires parentheses here }
Value: Function defined at &lt;standard input&gt;:...
(n): *@(int,int)(n,n)
atlas&gt; g(f) { call g with new value of f }
Value: [  0,  1, 25 ]
</pre></div>
</div>
<p>The &#8216;name : value&#8217; syntax is also available for values of non-function type,
in which case it is strictly equivalent to &#8216;set name = value&#8217;.</p>
<p>Although the design of axis aims at always giving variables a value at their
introduction, deducing their type from that value and avoiding the possibility
of uninitialized variables, it does allow introducing a global variable
without specifying an initial value, but only a type. To this end there is the
variation of the &#8216;name : value&#8217; syntax consisting of writing &#8216;name : type&#8217;
instead. For instance the function variable &#8216;f&#8217; above could have been
introduced by:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>atlas&gt; f: (int-&gt;int)
Declaring identifier &#39;f&#39;: (int-&gt;int)
</pre></div>
</div>
<p>after which it has a type but no value, whence the following gives no type
error but a runtime error:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>atlas&gt; g(f)
Runtime error:
  Taking value of uninitialized variable &#39;f&#39;
Evaluation aborted.
</pre></div>
</div>
<p>(it would be however possible to use &#8216;f&#8217; in unevaluated function definitions
at this point). Before doing anything useful with &#8216;f&#8217;, it must be assigned to:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>atlas&gt; f := ((int n): 2*n+3)
Value: Function defined at &lt;standard input&gt;:...
(n): +@(int,int)(*@(int,int)(2,n),3)
atlas&gt; g(f)
Value: [  3, 13, 13 ]
</pre></div>
</div>
<p>(Note that after the assignment to &#8216;f&#8217; its function body is printed in an
internal representation, in which overload resolution has been made explicit
by writing operators prefix and followed by &#64;argument_types; if there had been
any implicit conversion, it would also have been made visible by a somewhat
cryptic code. If a command is an assignment, the value assigned is printed, as
it is for any command that is an expression returning a value; this printing
can however be suppressed by adding &#8216;;()&#8217; at the end of the command.)</p>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="control_structures.html" class="btn btn-neutral float-right" title="Control Structures" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="def_func_op.html" class="btn btn-neutral" title="Defining Functions and Operators" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, atlasofliegroups.org.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.6',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>